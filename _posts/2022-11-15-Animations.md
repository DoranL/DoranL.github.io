---
layout: single
title: "DEV2 애니메이션"
---

<span style = "color:green">캐릭터 이동2편 내용 정리</span>

***

> 블렌드스페이스 1d
>
> 애니메이션 블루프린트
>
> 애니메이션 리타깃

***

<br/>

이번 장은 앞서 나왔던 애니메이션 몽타주와 Idle/Walk/Run 블렌드스페이스와 애니메이션 블루프린터의 

AnimGraph와 이벤트그래프에 대해 살펴보고 다른 캐릭의 애니메이션을 리타깃하여 PELIA에게 적용시키는

방법에 대해 살펴보겠습니다. 

설명 전 이번 장에서 소개할 친구는 첫 번째 맵에서 정찰병 역할을 하는 캐릭터로 PELIA가 침범을 하면

경고를 하고 무시할 경우 북을 쳐서 정찰병의 아군을 불러들이는 이벤트를 하는 캐릭터로 무시무시하게 생겼지만 

노래를 좋아하고 겁이 많은 오크입니다.

![이미지](/img/spotter.JPG)

<br/>

<mark>블렌드스페이스</mark>

1. 블렌드 스페이스 1d 생성

<mark>애니메이션 블루프린트</mark>

1.  이벤트그래프 작성
2.  스테이트 머신 추가 

<mark>애니메이션 리타깃</mark>

1.  T-pose로 상태 통일,  스켈레톤이 없는 캐릭터에 대한 리타깃
2.  애님 에셋 리타깃

<br/>

블렌드스페이스 1.

아래 사진에서 보면 Blendspace 1d 생성 시 해당 스켈레톤을 선택하여 제작하고 해당 게임 경우 무기 장착 시 이동하는 모션과 장착하지 않았을 때 애니메이션이 다르기 때문에 두개의 블렌드 스페이스를 제작하였습니다.

![이미지](/img/blendspace1d.JPG)

![이미지](/img/blendspace1d1.JPG)

![이미지](/img/blendspace1d2.JPG)

<center>무장 상태의 IdleWalkRun</center>

![이미지](/img/blendspace_uarm.JPG)

<center>비무장 상태의 IdleWalkRun</center>

<br/>

애니메이션 블루프린트 1.

애니메이션 블루프린트 생성은 블렌드스페이스 생성과정과 비슷하기 때문에 넘어가고 

이벤트그래프 작성 창에 대해 설명하겠습니다.

이벤트그래프에서 맨위에 보이는 Blueprint Update Animation 이벤트는 블루프린트에 필요한 

값 계산이나 업데이트를 할 수 있도록 하기 위해 매 프레임 실행되는 이벤트입니다.  

![이미지](/img/Eventgraph.JPG)

<br/>

애니메이션 블루프린트 2.

AnimGraph  애니메이션 상태와 순서를 나타내는 스테이트 머신을 새로 추가하고(Locomotion) 

결과 포즈를 얻어 다른 데서 사용할 수 있는 캐시 포즈에 저장 

Locomotion에서 정의한 sprint, jump 등 동작을 최종 애니메이션 포즈에 전달 슬롯 경우 슬롯을 사용하는 

애니메이션 몽타주가 재생 호출되면, 애님 그래프 안에서 호출됩니다.

![이미지](/img/animgraph.JPG)

Locomotion에서 구현한 기능 하나만을 다뤄보도록 하겠습니다. 

IdleWalkRun을 살펴보자

![이미지](/img/armuarm.JPG)

비무장에서 무장에서 가는 조건문을 살펴보면 플레이어에 장착된 오브젝트를 가져오고 

비무장이 아닐 경우 Armed 스테이트 상태로 이동하게 되고  movement speed를 받아 기존에 작성한 

Blendspace를 속도에 따라 실행하게 됩니다.

![이미지](/img/uarm.JPG)

![이미지](/img/arm.JPG)

<br/>

애니메이션 리타깃 1.

캐릭터가 없는 경우 릭 선택에서 인간 릭을 선택하고 소스와 타깃을 하나씩 매치시켜주고 리타깃하는 캐릭터와 동일하게 T 포즈로 변경 후 현재 포즈 사용으로 저장을 시켜줍니다.

![이미지](/img/retarget.JPG)



애니메이션 리타깃 2.

소스와 타깃에 넣어주고 리타깃을 하면 다른 캐릭터의 애니메이션을 사용 가능합니다.

![이미지](/img/retarget1.JPG)

<br/>

이번 장에서는 영상은 생략하도록 하고 다음 장에서는 HUD를 다루도록 하겠습니다.
